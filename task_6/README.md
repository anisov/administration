# Задание

## Работа с загрузчиком.

1. Попасть в систему без пароля.
2. Установить систему с LVM, после чего переименовать VG.
3. Добавить модуль в initrd.

## Описание выполнения.

### 1. Попасть в систему без пароля.

1) Для получения доступа необходимо открыть GUI VirtualBox (или другой систему
   виртуализации), запустить виртуальную машину и при выборе ядра длā загрузки нажать `e` - в
   данном контексте edit. Попадаем в окно где мы можем изменить параметры загрузки:
2) В конце строки начинающейся с linux16 добавляем `rd.break` и нажимаем `сtrl-x` для загрузки в систему. Так же мне пришлось удалить параметр `console=ttyS0,115200n8`, без удаления данного параметра `rd.break` не работал. Загрузка системы будет остановлена в момент загрузки Initramfs.
3) Попадаем в emergency mode. Наша корневая файловая система смонтирована в режиме read-only, она находиться в `/sysroot`, в будущем именно на неё мы переключимся(она будет примонтирована к /).
4) Выполняем следующие действия:
   1) Корнефая фс примонтирована в режиме ro, переделываем на rw.
      
      `mount -o remount,rw /sysroot`
   2) Создаём изолированое окружение, где /sysroot отображается как /.
      
      `chroot /sysroot`
   3) Изменяем пароль.
      
      `passwd root`
   4) В centos есть selinux и нужно заново определить все метки безопасности для всех файлов иначе не пустит.
      
      `touch /.autorelabel`
   5) `exit` выйти из chroot.
   6) `exit` выйти из консоли.

### 2. Установить систему с LVM, после чего переименовать VG.

Запустить скрипт: `rename_vg_script.sh`.
`sudo /vagrant/./rename_vg_script.sh`

### 3. Добавить модуль в initrd.

Скрипты модулей хранятся в каталоге /usr/lib/dracut/modules.d/.

Запускаем скрипт: `add_module.sh`
`sudo /vagrant/./add_module.sh`
Во время загрузки будет отображён пингвин.

**ОС**: CentOS


